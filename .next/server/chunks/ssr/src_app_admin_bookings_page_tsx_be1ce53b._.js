module.exports=[13181,a=>{"use strict";var b=a.i(87924),c=a.i(38246),d=a.i(15618),e=a.i(28790),f=a.i(67329),g=a.i(41675),h=a.i(13749),i=a.i(50522),j=a.i(99570),k=a.i(75083),l=a.i(72131),m=a.i(28337),n=a.i(23292),o=a.i(56711),p=a.i(17643),q=a.i(87532),r=a.i(69012),s=a.i(33508),t=a.i(66718),u=a.i(91119),v=a.i(80701);function w({searchQuery:a,setSearchQuery:c,filterStatus:d,setFilterStatus:e}){return(0,b.jsx)(u.Card,{className:"p-4 border shadow-sm",children:(0,b.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,b.jsxs)("div",{className:"relative flex-1",children:[(0,b.jsx)(q.Search,{className:"absolute left-3 top-3 h-4 w-4 text-gray-500"}),(0,b.jsx)(t.Input,{placeholder:"Cari Kode Booking / Nama Pelanggan...",className:"pl-9 pr-8",value:a,onChange:a=>c(a.target.value)}),a&&(0,b.jsx)("button",{onClick:()=>c(""),className:"absolute right-3 top-3 text-gray-400 hover:text-gray-600",children:(0,b.jsx)(s.X,{className:"h-4 w-4"})})]}),(0,b.jsx)("div",{className:"w-full md:w-[200px]",children:(0,b.jsxs)(v.Select,{value:d,onValueChange:e,children:[(0,b.jsxs)(v.SelectTrigger,{children:[(0,b.jsx)(r.Filter,{className:"w-4 h-4 mr-2 text-gray-500"}),(0,b.jsx)(v.SelectValue,{placeholder:"Filter Status"})]}),(0,b.jsxs)(v.SelectContent,{children:[(0,b.jsx)(v.SelectItem,{value:"all",children:"Semua Status"}),(0,b.jsx)(v.SelectItem,{value:"1",children:"Menunggu Bayar"}),(0,b.jsx)(v.SelectItem,{value:"2",children:"Perlu Konfirmasi"}),(0,b.jsx)(v.SelectItem,{value:"3",children:"Terkonfirmasi"}),(0,b.jsx)(v.SelectItem,{value:"5",children:"Selesai"}),(0,b.jsx)(v.SelectItem,{value:"4",children:"Dibatalkan"})]})]})})]})})}var x=a.i(92052),y=a.i(25579),z=a.i(93901),A=a.i(24987),B=a.i(20146),C=a.i(86304);function D({selectedDate:a,setSelectedDate:c,bookedDays:d,bookingsOnSelectedDate:e,onViewDetail:f}){return(0,b.jsxs)("div",{className:"flex flex-col lg:flex-row gap-6 items-start",children:[(0,b.jsx)(u.Card,{className:"flex-none w-full lg:w-auto",children:(0,b.jsx)(u.CardContent,{className:"p-4 flex justify-center",children:(0,b.jsx)(B.Calendar,{mode:"single",selected:a,onSelect:c,className:"rounded-md border shadow-sm",disabled:{before:new Date},modifiers:{booked:d},modifiersStyles:{booked:{fontWeight:"bold",color:"#D93F21",textDecoration:"underline"}}})})}),(0,b.jsxs)(u.Card,{className:"flex-1 w-full min-h-[350px]",children:[(0,b.jsx)(u.CardHeader,{className:"border-b pb-3",children:(0,b.jsxs)(u.CardTitle,{className:"text-lg flex items-center gap-2",children:[(0,b.jsx)(g.Calendar,{className:"w-5 h-5 text-[#D93F21]"}),"Jadwal: ",a?(0,o.format)(a,"dd MMMM yyyy",{locale:z.id}):"-"]})}),(0,b.jsx)(u.CardContent,{className:"pt-4",children:0===e.length?(0,b.jsx)("div",{className:"text-center py-10 text-gray-500",children:(0,b.jsx)("p",{children:"Tidak ada jadwal booking pada tanggal ini."})}):(0,b.jsx)("div",{className:"space-y-3",children:e.sort((a,b)=>a.jam_mulai.localeCompare(b.jam_mulai)).map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border border-gray-100 hover:border-[#D93F21]/30 hover:shadow-sm transition-all cursor-pointer bg-white",onClick:()=>f(a),children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsxs)("div",{className:"bg-orange-50 text-[#D93F21] p-2 rounded-md font-mono text-sm font-bold text-center w-24",children:[a.jam_mulai.substring(0,5)," ",(0,b.jsx)("br",{}),(0,b.jsx)("span",{className:"text-xs font-normal text-gray-500",children:"s/d"})," ",(0,b.jsx)("br",{}),a.jam_selesai.substring(0,5)]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-bold text-gray-900",children:a.nama_pengirim||a.user?.name||"Tamu"}),(0,b.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-500 mt-1",children:[(0,b.jsx)(A.MapPin,{className:"w-3 h-3"})," ",a.lapangan?.nama_lapangan,a.acara&&(0,b.jsxs)("span",{className:"bg-gray-100 px-1.5 rounded",children:["Kegiatan: ",a.acara]})]})]})]}),(0,b.jsx)("div",{className:"flex items-center gap-3",children:(a=>{switch(a){case 1:return(0,b.jsx)(C.Badge,{variant:"outline",className:"text-yellow-700 bg-yellow-50 border-yellow-200",children:"Pending"});case 2:return(0,b.jsx)(C.Badge,{className:"bg-blue-500 hover:bg-blue-600",children:"Verifikasi"});case 3:return(0,b.jsx)(C.Badge,{className:"bg-green-600 hover:bg-green-700",children:"OK"});case 5:return(0,b.jsx)(C.Badge,{variant:"outline",className:"bg-gray-100",children:"Selesai"});default:return(0,b.jsx)(C.Badge,{variant:"secondary",children:"Unknown"})}})(a.status_booking_id)})]},a.id))})})]})]})}function E(){let{bookings:a,loading:q,totalData:r,viewMode:s,setViewMode:t,searchQuery:u,setSearchQuery:v,filterStatus:z,setFilterStatus:A,selectedDate:B,setSelectedDate:C,bookingsOnSelectedDate:E,bookedDays:F,currentPage:G,totalPages:H,handlePageChange:I,selectedBooking:J,isDialogOpen:K,setIsDialogOpen:L,isProcessing:M,handleViewDetail:N,handleApprove:O,handleReject:P,fetchBookings:Q}=function(){let[a,b]=(0,l.useState)([]),[c,d]=(0,l.useState)(!0),[e,f]=(0,l.useState)("table"),[g,h]=(0,l.useState)(""),[i,j]=(0,l.useState)("all"),[k,q]=(0,l.useState)(new Date),[r,s]=(0,l.useState)(1),[t,u]=(0,l.useState)(10),[v,w]=(0,l.useState)(null),[x,y]=(0,l.useState)(!1),[z,A]=(0,l.useState)(!1),B=(0,l.useCallback)(a=>{if(!Array.isArray(a))return[];let b=new Date;return a.map(a=>{if(!a)return a;let c=new Date(`${a.tanggal_booking}T${a.jam_selesai}`);return 3===a.status_booking_id&&b>c?{...a,status_booking_id:5,status_booking:{...a.status_booking||{},id:5,nama_status:"Selesai",color:"success"}}:a})},[]),C=(0,l.useCallback)(async()=>{try{let a=(await m.default.get("/api/bookings")).data,c=[];Array.isArray(a)?c=a:a?.data&&Array.isArray(a.data)?c=a.data:(console.warn("Format data booking tidak valid:",a),c=[]);let d=B(c);b(d)}catch(a){console.error("Fetch error:",a),b([])}finally{d(!1)}},[B]);(0,l.useEffect)(()=>{d(!0),C();let a=setInterval(C,3e4);return()=>clearInterval(a)},[C]);let D=Array.isArray(a)?a:[],E=D.filter(a=>{if(!a)return!1;let b=g.toLowerCase(),c=a.kode_booking?.toLowerCase().includes(b)||a.user?.name?.toLowerCase().includes(b)||a.nama_pengirim&&a.nama_pengirim.toLowerCase().includes(b)||!1,d="all"===i||a.status_booking_id?.toString()===i;return c&&d}),F=E.length,G=Math.ceil(F/t)||1,H=r*t,I=E.slice(H-t,H),J=D.filter(a=>k&&a?.tanggal_booking===(0,o.format)(k,"yyyy-MM-dd")&&a?.status_booking_id!==4),K=D.filter(a=>a?.status_booking_id!==4&&a?.tanggal_booking).map(a=>new Date(a.tanggal_booking)),L=async a=>{if((await p.sweetAlert.confirm("Konfirmasi Booking","Apakah Anda yakin ingin mengkonfirmasi booking ini?")).isConfirmed){A(!0);try{await m.default.patch(`/api/bookings/${a}/status`,{status_booking_id:3}),n.toast.success("Booking berhasil dikonfirmasi!"),y(!1),C()}catch(a){n.toast.error(a.response?.data?.message||"Gagal konfirmasi.")}finally{A(!1)}}},M=async a=>{if((await p.sweetAlert.confirm("Tolak Booking","Apakah Anda yakin ingin menolak booking ini?","warning")).isConfirmed){A(!0);try{await m.default.patch(`/api/bookings/${a}/cancel`),n.toast.success("Booking dibatalkan."),y(!1),C()}catch(a){n.toast.error(a.response?.data?.message||"Gagal membatalkan.")}finally{A(!1)}}};return{bookings:I,allBookings:D,loading:c,totalData:F,viewMode:e,setViewMode:f,searchQuery:g,setSearchQuery:h,filterStatus:i,setFilterStatus:j,selectedDate:k,setSelectedDate:q,bookingsOnSelectedDate:J,bookedDays:K,currentPage:r,itemsPerPage:t,totalPages:G,handlePageChange:a=>{s(a)},selectedBooking:v,isDialogOpen:x,setIsDialogOpen:y,isProcessing:z,handleViewDetail:a=>{w(a),y(!0)},handleApprove:L,handleReject:M,fetchBookings:C}}();return(0,b.jsxs)("div",{className:"space-y-6 pb-20 p-6",children:[" ",(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Manajemen Booking"}),(0,b.jsx)("p",{className:"text-gray-500 text-sm mt-1",children:"Validasi pembayaran dan kelola jadwal lapangan secara real-time."})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(j.Button,{variant:"outline",size:"icon",onClick:Q,title:"Refresh Data",disabled:q,className:"h-10 w-10",children:(0,b.jsx)(e.RefreshCcw,{className:`w-4 h-4 ${q?"animate-spin":""}`})}),(0,b.jsx)(c.default,{href:B?`/admin/bookings/create?date=${String(B.getFullYear()).padStart(4,"0")}-${String(B.getMonth()+1).padStart(2,"0")}-${String(B.getDate()).padStart(2,"0")}`:"/admin/bookings/create",children:(0,b.jsxs)(j.Button,{className:"bg-[#D93F21] hover:bg-[#b9351b] h-10 px-4",children:[(0,b.jsx)(d.Plus,{className:"w-4 h-4 mr-2"})," Input Manual"]})})]})]}),(0,b.jsxs)(k.Tabs,{defaultValue:"table",value:s,onValueChange:t,className:"w-full",children:[(0,b.jsxs)(k.TabsList,{className:"grid w-full max-w-[400px] grid-cols-2 mb-6 p-1 bg-gray-100/80",children:[(0,b.jsxs)(k.TabsTrigger,{value:"table",className:"data-[state=active]:bg-white data-[state=active]:shadow-sm",children:[(0,b.jsx)(f.List,{className:"w-4 h-4 mr-2"})," Daftar List"]}),(0,b.jsxs)(k.TabsTrigger,{value:"calendar",className:"data-[state=active]:bg-white data-[state=active]:shadow-sm",children:[(0,b.jsx)(g.Calendar,{className:"w-4 h-4 mr-2"})," Kalender Jadwal"]})]}),(0,b.jsxs)(k.TabsContent,{value:"table",className:"space-y-6 mt-0 animate-in fade-in-50 duration-300",children:[(0,b.jsx)(w,{searchQuery:u,setSearchQuery:v,filterStatus:z,setFilterStatus:A}),(0,b.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden",children:[(0,b.jsx)(x.default,{bookings:a,loading:q,onView:N}),!q&&r>0&&(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 border-t bg-gray-50/50",children:[(0,b.jsxs)("div",{className:"text-sm text-gray-500",children:["Menampilkan ",(0,b.jsx)("strong",{children:a.length})," dari ",(0,b.jsx)("strong",{children:r})," data"]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(j.Button,{variant:"outline",size:"sm",onClick:()=>I(G-1),disabled:1===G,className:"h-8 w-8 p-0",children:(0,b.jsx)(h.ChevronLeft,{className:"h-4 w-4"})}),(0,b.jsxs)("span",{className:"text-sm font-medium px-2 min-w-[80px] text-center",children:["Hal ",G," / ",H]}),(0,b.jsx)(j.Button,{variant:"outline",size:"sm",onClick:()=>I(G+1),disabled:G===H,className:"h-8 w-8 p-0",children:(0,b.jsx)(i.ChevronRight,{className:"h-4 w-4"})})]})]})]})]}),(0,b.jsx)(k.TabsContent,{value:"calendar",className:"mt-0 animate-in fade-in-50 duration-300",children:(0,b.jsx)("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-4 md:p-6",children:(0,b.jsx)(D,{selectedDate:B,setSelectedDate:C,bookedDays:F,bookingsOnSelectedDate:E,onViewDetail:N})})})]}),(0,b.jsx)(y.default,{isOpen:K,onOpenChange:L,booking:J,onApprove:O,onReject:P,isProcessing:M,onRefresh:Q})]})}a.s(["default",()=>E],13181)}];

//# sourceMappingURL=src_app_admin_bookings_page_tsx_be1ce53b._.js.map