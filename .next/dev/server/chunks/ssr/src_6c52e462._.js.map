{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///E:/03-NGODING/20-MainDiHatta.id/FrontEnd/maindihatta-frontend/src/components/ui/separator.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAEA;AALA;;;;;AAOA,MAAM,0BAAY,mNAAgB,CAIhC,CACE,EAAE,SAAS,EAAE,cAAc,YAAY,EAAE,aAAa,IAAI,EAAE,GAAG,OAAO,EACtE,oBAEA,8OAAC,6KAAuB;QACtB,KAAK;QACL,YAAY;QACZ,aAAa;QACb,WAAW,IAAA,yHAAE,EACX,sBACA,gBAAgB,eAAe,mBAAmB,kBAClD;QAED,GAAG,KAAK;;;;;;AAIf,UAAU,WAAW,GAAG,6KAAuB,CAAC,WAAW"}},
    {"offset": {"line": 34, "column": 0}, "map": {"version":3,"sources":["file:///E:/03-NGODING/20-MainDiHatta.id/FrontEnd/maindihatta-frontend/src/app/pelanggan/pembayaran/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport axios from '@/lib/axios';\r\nimport Image from 'next/image';\r\nimport { useRouter, useSearchParams } from 'next/navigation';\r\nimport { toast } from 'sonner';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { useCart } from '@/context/CartContext'; \r\nimport { Banknote, CreditCard, Loader2, ArrowLeft } from 'lucide-react';\r\n\r\nimport { Button } from '@/components/ui/button';\r\nimport { Separator } from '@/components/ui/separator';\r\n\r\nimport { PaymentMethod } from '@/types';\r\n\r\nexport default function PembayaranPage() {\r\n    const router = useRouter();\r\n    const searchParams = useSearchParams();\r\n    const tableNumber = searchParams.get('table');\r\n    const { user } = useAuth({ middleware: 'auth' });\r\n    \r\n    const { cart, totalPrice, totalItems, clearCart } = useCart();\r\n\r\n    const [paymentMethods, setPaymentMethods] = useState<PaymentMethod[]>([]);\r\n    const [selectedPayment, setSelectedPayment] = useState<number | null>(null);\r\n    \r\n    const [isProcessing, setIsProcessing] = useState(false);\r\n    \r\n    const [isSuccessRedirecting, setIsSuccessRedirecting] = useState(false);\r\n\r\n    useEffect(() => {\r\n        if (cart.length === 0 && !isSuccessRedirecting) {\r\n            toast.error(\"Keranjang kosong, kembali ke menu.\");\r\n            router.replace('/pelanggan/produk');\r\n        }\r\n    }, [cart, router, isSuccessRedirecting]);\r\n\r\n    useEffect(() => {\r\n        const fetchPayments = async () => {\r\n            try {\r\n                const res = await axios.get('/api/paymentMethods');\r\n                setPaymentMethods(res.data.filter((p: any) => p.is_aktif));\r\n            } catch (error) {\r\n                console.error(error);\r\n                toast.error(\"Gagal memuat metode pembayaran.\");\r\n            }\r\n        };\r\n        fetchPayments();\r\n    }, []);\r\n\r\n    const formatRupiah = (num: number) => \r\n        new Intl.NumberFormat('id-ID', { style: 'currency', currency: 'IDR', minimumFractionDigits: 0 }).format(num);\r\n\r\n    const handleSelectPayment = (method: PaymentMethod) => {\r\n        setSelectedPayment(method.id);\r\n    };\r\n\r\n    const handlePayNow = async () => {\r\n        if (!selectedPayment) return toast.error(\"Pilih metode pembayaran!\");\r\n        if (cart.length === 0) return toast.error(\"Keranjang kosong.\");\r\n        \r\n        if (!tableNumber) return toast.error(\"Nomor meja hilang. Silakan ulangi pemesanan.\");\r\n\r\n        setIsProcessing(true);\r\n        try {\r\n            const validItems = cart.filter(i => i.qty > 0);\r\n            \r\n            if (validItems.length === 0) throw new Error('Item tidak valid.');\r\n\r\n            const payload = {\r\n                payment_method_id: selectedPayment,\r\n                total_bayar: 0, \r\n                nama_pelanggan: `${user?.name || 'Guest'} (Meja ${tableNumber})`,\r\n                nomor_meja: tableNumber,\r\n                items: validItems.map(item => ({\r\n                    produk_resto_id: item.id,\r\n                    jumlah: item.qty,\r\n                    catatan: item.catatan || null\r\n                }))\r\n            };\r\n\r\n            const res = await axios.post('/api/transaksiRestos', payload);\r\n            \r\n            setIsSuccessRedirecting(true);\r\n            \r\n            clearCart(); \r\n            \r\n            const selectedMethodObj = paymentMethods.find(p => p.id === selectedPayment);\r\n            const isCash = selectedMethodObj?.nama_metode.toLowerCase().includes('cash') || \r\n                           selectedMethodObj?.nama_metode.toLowerCase().includes('tunai');\r\n            const typeParam = isCash ? 'cash' : 'transfer';\r\n\r\n            router.push(`/pelanggan/pembayaran/sukses?code=${res.data.kode_transaksi}&type=${typeParam}`);\r\n\r\n        } catch (error: any) {\r\n            console.error('Payment error:', error);\r\n            const msg = error?.response?.data?.message || error?.message || \"Gagal memproses pesanan.\";\r\n            toast.error(msg);\r\n            setIsProcessing(false); \r\n        } \r\n    };\r\n\r\n    if (cart.length === 0 && !isSuccessRedirecting) return null;\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-white font-sans text-gray-900 py-10 px-4 md:px-8\">\r\n            \r\n            {/* Header */}\r\n            <div className=\"max-w-6xl mx-auto mb-8 flex items-center\">\r\n                <Button variant=\"ghost\" onClick={() => router.back()} className=\"mr-4 text-gray-500 hover:bg-gray-100 rounded-full\">\r\n                    <ArrowLeft className=\"w-5 h-5\" />\r\n                </Button>\r\n                <h1 className=\"text-3xl font-extrabold text-[#D93F21] mx-auto pr-10\">Selesaikan Pesanan</h1>\r\n            </div>\r\n\r\n            <div className=\"max-w-6xl mx-auto bg-white rounded-[2.5rem] shadow-xl overflow-hidden border border-gray-100\">\r\n                <div className=\"flex flex-col lg:flex-row min-h-[600px]\">\r\n                    \r\n                    {/* KIRI: IMAGE */}\r\n                    <div className=\"w-full lg:w-1/2 relative min-h-[300px] lg:min-h-full\">\r\n                        <Image \r\n                            src=\"/images/gambar-pembayaran.png\" \r\n                            alt=\"Payment Illustration\"\r\n                            fill\r\n                            className=\"object-cover\"\r\n                        />\r\n                        <div className=\"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent flex items-end p-10\">\r\n                            <div className=\"text-white\">\r\n                                <h3 className=\"text-2xl font-bold mb-2\">Selesaikan Pesananmu</h3>\r\n                                <p className=\"text-sm opacity-90\">Nikmati hidangan lezat segera setelah pembayaran dikonfirmasi.</p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"w-full lg:w-1/2 p-8 md:p-12 flex flex-col justify-center\">\r\n                        \r\n                        <div className=\"mb-8\">\r\n                            <h3 className=\"text-[#D93F21] font-bold text-lg mb-4\">Info Pemesan</h3>\r\n                            <div className=\"space-y-3 pl-1\">\r\n                                <div className=\"flex justify-between items-center border-b border-gray-200 pb-2\">\r\n                                    <span className=\"text-gray-500 text-sm\">Nama Pelanggan</span>\r\n                                    <span className=\"font-bold\">{user?.name}</span>\r\n                                </div>\r\n                                <div className=\"flex justify-between items-center border-b border-gray-200 pb-2\">\r\n                                    <span className=\"text-gray-500 text-sm\">Nomor Meja</span>\r\n                                    <span className=\"font-bold text-xl text-[#D93F21]\">{tableNumber || '-'}</span>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"mb-8\">\r\n                            <h3 className=\"text-[#D93F21] font-bold text-lg mb-4\">Rincian Menu ({totalItems})</h3>\r\n                            <div className=\"space-y-4 max-h-[200px] overflow-y-auto pr-2 custom-scrollbar mb-4\">\r\n                                {cart.map((item) => (\r\n                                    <div key={item.id} className=\"flex items-center gap-4\">\r\n                                        <div className=\"w-12 h-12 rounded-lg overflow-hidden relative bg-gray-100 shrink-0 border border-gray-100\">\r\n                                            <Image src={item.foto_url || ''} alt={item.nama_produk} fill className=\"object-cover\" unoptimized />\r\n                                        </div>\r\n                                        <div className=\"flex-1\">\r\n                                            <p className=\"font-bold text-gray-900 text-sm\">{item.nama_produk}</p>\r\n                                            <p className=\"text-xs text-gray-500\">{item.qty} x {formatRupiah(Number(item.harga_jual))}</p>\r\n                                        </div>\r\n                                        <p className=\"font-bold text-sm text-[#D93F21]\">{formatRupiah(Number(item.harga_jual) * item.qty)}</p>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n\r\n                            <div className=\"space-y-2 text-sm pl-1\">\r\n                                <div className=\"flex justify-between text-gray-500\">\r\n                                    <span>Subtotal</span>\r\n                                    <span>{formatRupiah(totalPrice)}</span>\r\n                                </div>\r\n                                <div className=\"flex justify-between text-gray-500\">\r\n                                    <span>Total tax</span>\r\n                                    <span className=\"font-medium text-gray-900\">Rp 0</span>\r\n                                </div>\r\n                                <Separator className=\"my-3\" />\r\n                                <div className=\"flex justify-between font-bold text-lg text-gray-900\">\r\n                                    <span>Total Bayar</span>\r\n                                    <span>{formatRupiah(totalPrice)}</span>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* 3. Payments Method */}\r\n                        <div className=\"mb-10\">\r\n                            <h3 className=\"text-[#D93F21] font-bold text-lg mb-4\">Metode Pembayaran</h3>\r\n                            <div className=\"grid grid-cols-2 gap-4\">\r\n                                {paymentMethods.map((method) => (\r\n                                    <div \r\n                                        key={method.id}\r\n                                        onClick={() => handleSelectPayment(method)}\r\n                                        className={`\r\n                                            cursor-pointer rounded-xl border-2 p-4 flex flex-col items-center justify-center gap-2 transition-all duration-200\r\n                                            ${selectedPayment === method.id \r\n                                                ? 'border-[#D93F21] bg-red-50 text-[#D93F21]' \r\n                                                : 'border-gray-100 hover:border-gray-300 text-gray-600 hover:bg-gray-50'\r\n                                            }\r\n                                        `}\r\n                                    >\r\n                                        {method.nama_metode.toLowerCase().includes('cash') || method.nama_metode.toLowerCase().includes('tunai') ? (\r\n                                            <Banknote className=\"w-8 h-8\" />\r\n                                        ) : (\r\n                                            <CreditCard className=\"w-8 h-8\" />\r\n                                        )}\r\n                                        <span className=\"font-bold text-sm text-center\">{method.nama_metode}</span>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n\r\n                        <Button \r\n                            className=\"w-full bg-[#D93F21] hover:bg-[#b9351b] text-white font-bold py-8 rounded-2xl text-xl shadow-xl shadow-orange-200 transition-transform active:scale-95\"\r\n                            onClick={handlePayNow}\r\n                            disabled={isProcessing}\r\n                        >\r\n                            {isProcessing ? <Loader2 className=\"animate-spin mr-2 h-6 w-6\" /> : \"Buat Pesanan\"}\r\n                        </Button>\r\n                        \r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}"],"names":[],"mappings":"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"}}]
}